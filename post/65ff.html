<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <!-- cungudafa百度收录验证编号 -->
  <!-- <meta name="baidu-site-verification" content="LukfTcyXmC" /> -->
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">计算机网络中的安全 | Hexo</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/style.css" type="text/css" media="all" id="saukra_css-css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/jquery.fancybox.min.css" media="all">  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/lib.min.css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/tags.css" media="all">
  
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/logo.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/fonts/LOGO/logo.css">
  
  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>

  <!-- 分析 -->
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <!-- Baidu Analytics -->

  
  <!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
  " type="text/css" media="all"> -->
  <script>
    /*Initial Variables*/
    var mashiro_option = new Object();
    var mashiro_global = new Object();
    mashiro_option.NProgressON = true;
    /* 
    * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
    * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
    */
    mashiro_option.email_domain = "";
    mashiro_option.email_name = "";
    mashiro_option.cookie_version_control = "";
    mashiro_option.qzone_autocomplete = false;
    mashiro_option.site_name = "happysnaker开心";
    mashiro_option.author_name = "开心";
    mashiro_option.site_url = "http://happysnaker.gitee.io/blog";
    mashiro_option.v_appId = "";//
    mashiro_option.v_appKey = "";//
    mashiro_option.mathjax = "1";
    mashiro_option.copyright_enable = "false" ;
    mashiro_option.copyright_minCharNumber = parseInt("120") ;
    mashiro_option.copyright_description = "本文章著作权归作者所有，任何形式的转载都请注明出处。" ;
    mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
    mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

    // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
    // mashiro_option.float_player_on = true;

    /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
    var bg = "https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(0).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(1).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(2).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(3).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(4).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(5).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(6).jpg.webp,https://cdn.jsdelivr.net/gh/cungudafa/cdn@2.0.9/img/cover/(7).jpg.webp".split(",");
    var bgindex = Math.floor(Math.random()*bg.length);
    if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
      alert('朋友，IE浏览器未适配哦~');
    }
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/blog/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/blog/css/prism-line-numbers.css" type="text/css"></head> 

<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <!-- Dynamic sliders -->
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <!-- Main content -->
  <section id="main-container">
    <!-- Top menu -->
    <div class="headertop filter-dot">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="http://happysnaker.gitee.io/blog">
          <img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>且停且忘且随风，且行且看且从容</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="http://github.com/happysnaker" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://www.zhihu.com/people/tian-xia-you-dao-81" target="_blank" class="social-github" title="zhihu">
                    <img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/zhihu.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="http://gitee.com/happysnaker" target="_blank" class="social-github" title="gitee">
                    <img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/social/gitee.png">
                  </a>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  
  <div id="video-container">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <!-- banner -->
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
        <span class="site-title">
            <span class="logolink logo">
                <a href="/">
                    <ruby>
                    <span class="sakuraso">Happysnaker</span>
                    <span class="no">の</span>
                    <span class="shironeko">小屋</span>
                    <rp></rp>
                    <rt class="logo">happysnaker</rt>
                    <rp></rp>
                    </ruby>
                  </a>
            </span>
          </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/blog/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/blog/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/blog/archives/">
                          <i class="fa fa-line-chart" aria-hidden="true"></i>
                          统计
                        </a>
                      </li>
                    
                      <li>
                        <a href="/blog/tags">
                          <i class="fa fa-tags" aria-hidden="true"></i>
                          标签
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/blog/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/blog/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      
      <!-- body -->
      <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/cungudafa/cdn/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1"
        class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content">  -->
        <!--套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <p>文章已收录我的仓库：<a target="_blank" rel="noopener" href="https://github.com/happysnaker/JavaLearningNotes">Java学习笔记</a></p>
<h1 id="计算机网络中的安全"><a href="#计算机网络中的安全" class="headerlink" title="计算机网络中的安全"></a>计算机网络中的安全</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文主要研究具体的算法思想而不关注具体的协议实现，在接下来的文章中我门再把目光投向 SSL&#x2F;TLS。</p>
<p>在具体分析之前，我们首先来思考一下计算机网络中会面临那些安全问题，只有理清楚了这些问题，我们才能知道为什么需要这些安全技术，并且和面试官谈的时候条理也能更清楚。</p>
<h3 id="报文机密性-我们的谈话会被窃听吗？"><a href="#报文机密性-我们的谈话会被窃听吗？" class="headerlink" title="报文机密性 - 我们的谈话会被窃听吗？"></a>报文机密性 - 我们的谈话会被窃听吗？</h3><p>当然会，你肯定不希望你的谈话会被别人监听，所以你需要一些加密手段让别人听不懂你的谈话。</p>
<p>网络中也是一样，如果不对报文加密，则任何一台中间计算机都可以窃听你的报文，如果报文中包含了你的银行密码这可就完蛋了。</p>
<h3 id="报文完整性-我收到的报文被篡改过吗？"><a href="#报文完整性-我收到的报文被篡改过吗？" class="headerlink" title="报文完整性 - 我收到的报文被篡改过吗？"></a>报文完整性 - 我收到的报文被篡改过吗？</h3><p>这里的完整性并不是数据丢失问题，数据丢失在应用层之下就应该通过校验码检测出来了，本文的完整性是指：<strong>报文有没有被篡改？</strong></p>
<p>你肯定不希望你的报文在网络中被别人篡改，所以必须要有些验证方法去验证报文完整性。</p>
<h3 id="端点鉴别-Alice，真的是你在给我发消息吗？"><a href="#端点鉴别-Alice，真的是你在给我发消息吗？" class="headerlink" title="端点鉴别 - Alice，真的是你在给我发消息吗？"></a>端点鉴别 - Alice，真的是你在给我发消息吗？</h3><p>你要怎么确定对方真的是 Alice，而不是 Bob 伪造的，正如在现实生活中，你要怎么确定和你裸聊的是一个女性而不是一个五旬老汉？</p>
<p>带着上述三大问题，让我们一起来看看计算机科学家们提出了什么样的解决方案。</p>
<img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221154104138.png" alt="image-20211221154104138" style="zoom: 50%;" />

<h2 id="报文机密性"><a href="#报文机密性" class="headerlink" title="报文机密性"></a>报文机密性</h2><p>我们要保证报文是加密的，并且只有通信双方能够解密。</p>
<h3 id="对称密匙密码体制"><a href="#对称密匙密码体制" class="headerlink" title="对称密匙密码体制"></a>对称密匙密码体制</h3><p>这种体制中，通信双方协商好相同的密匙和算法，发送方利用密匙加密报文，而接收方利用密匙解密报文，因为其他人不知道密匙，所以其他人无法对报文解密。</p>
<p>加密方法有许多种，例如最简单的凯撒密码，它将所有字母后移 k 位，例如 abc 可能被替换为 bcd，此时 k &#x3D; 1 就是密匙。</p>
<p>在对称密匙体制中，主要采用<strong>块密码</strong>和<strong>流密码</strong>进行加密，流密码多用于WLAN中，我们主要看看块密码。</p>
<h4 id="块密码"><a href="#块密码" class="headerlink" title="块密码"></a>块密码</h4><p>块密码的主要原理是将明文分为固定大小的块，<strong>对每一种块都维护一个映射表以加密数据</strong>。</p>
<p>例如，假设块大小为 3，考虑下列映射表：</p>
<img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221155533383.png" alt="image-20211221155533383" style="zoom:50%;" />

<p>例如源数据为：000, 001, 101 将会被加密成 110, 111, 010。解密逆过程即可。</p>
<p>那么这里的映射表就是通信双方的密匙，上述表有 8 中输入，而每种输入又可能对应 8 种输出，所以想要破解密匙需要尝试 8 的阶乘种可能，阶乘函数上升是非常快的，当块大小变得比较大时，破解块密码在理论上说是不可能的。</p>
<p>但是，出现了新的问题，如果我们让块大小增大，假设为 64bit，那么交互的双方都必须维护一张长达 2^64 大小的映射表(表项为输入输出)，更可怕的情况是如果映射有所修改，那么这将是一个非常大的工作量。</p>
<p>取而代之是采用<strong>函数</strong>来模拟输入输出表，例如对所有二进制输入流进行亦或运算得到加密输出流。当然实际的函数不可能如此简单，它依赖于具体的实现。</p>
<p>获取我们还可以将每个加密块打乱，以实现让更小的函数映射模拟更大的块输入输出表。</p>
<p>例如我们用函数来模拟 64bit 输入输出表，我们将每个 64bit 作为一个块，但我们没有维护 64bit 的输入输出表，而是将这 64bit 分为 8 个 8bit 块，对<strong>每个 8bit 块维护一个特定的函数</strong>(图中的T1、T2….)，而后对这 8个加密的 8bit 块进行 64bit 函数置乱，使得每个 8bit 块被打乱，经过一定次数循环后，<strong>此时的 64bit 块就已经被完全打乱了</strong>，就好像我们采用了 64bit 输入输出表一样。</p>
<img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221161405027.png" alt="image-20211221161405027" style="zoom: 33%;" />

<p>在上图中，密匙是 9 个函数，即 8 个映射函数和 1 个置乱函数(假定循环次数已知)。这些函数都可以由一个唯一的<strong>二进制密匙</strong>生成，现在通信双方只需要维护一个二进制串即可，无须维护一个巨大的映射表。</p>
<p>典型的块密码协议如 DES 与 AES 都是采用函数而非预先设定的表，它们定义了一些列算法以生成这些小型函数映射与置乱函数排列，不过前提是需要一个密匙来生成。DES(就像我们例子中的) 的密匙比特串长度为 56，块大小为 64bit，在现代计算机运行速度下，2<sup>56</sup>中可能破解已非难事，因此 DES 已经被淘汰成为历史了，取而代之的是 AES，AES 的密匙长度最小为 128 位，理论上是不可能破解的。</p>
<blockquote>
<p>— 如何利用密匙生成 “特定小型表函数映射” 和 “特定排列函数”？</p>
<p>— 我也不知道。</p>
</blockquote>
<h4 id="如何提前协商密匙"><a href="#如何提前协商密匙" class="headerlink" title="如何提前协商密匙"></a>如何提前协商密匙</h4><p>如何提前协商密匙在对称密匙体制中是最为重要的一个问题，这个过程必须足够安全才行。</p>
<p>不过解决办法总是有的，就像我们马上要讲的，可以利用非对称密匙密码体制来协商一个相同的密匙。</p>
<h3 id="非对称密匙密码体制-公开密匙密码"><a href="#非对称密匙密码体制-公开密匙密码" class="headerlink" title="非对称密匙密码体制(公开密匙密码)"></a>非对称密匙密码体制(公开密匙密码)</h3><p>在非堆成密匙密码体制中，假定每个网络用户都拥有私匙和公匙，私匙是个人私有的，公匙是公开在网络上的，我们定义利用私匙处理数据算法为 S，而利用公匙处理数据算法为 P。</p>
<p>那么，非对称密匙体制要求有如下公式成立：<br>$$<br>S(P(data)) &#x3D; data \<br>P(S(data)) &#x3D; data<br>$$<br>其中 data 是网络上传输的二进制比特流，现在假设 A 要像 B 发送消息 data，那么 A 直接直接用 B 的公匙(公开的)对 data 加密得到 $P_B(data)$，那么 B 可以直接利用其私匙对数据解密 $S_B(P_B(data)) &#x3D; data$，这样 B 就能够还原原文，而其他人不知道 B 的私匙，所以无法破解密文。</p>
<p>你可能会想，天啊，怎么可能会有这种算法！如果你真有这种想法，说明你低估了数论的魅力。 </p>
<h4 id="RSA算法"><a href="#RSA算法" class="headerlink" title="RSA算法"></a>RSA算法</h4><p>RSA 已经成为了公开密匙密码的代言人，RSA 算法结论如下：<br>$$<br>(m^e \ mod \ n)^d \ mod \ n &#x3D; (m^d \ mod \ n)^e \ mod \ n &#x3D; m \ e, d 是经过特殊运算生成的<br>$$<br>通过这个神奇的结果，我们选定 e 和 d 为公匙和私匙，假定 m 为 报文 message，那么有：<br>$$<br>P(m) &#x3D; m^e \ mod \ n \<br>S(m) &#x3D; m^d \ mod \ n \<br>S(P(m)) &#x3D; P(m)^d \ mod \ n &#x3D; (m^e \ mod \ n)^d \ mod \ n &#x3D; m \<br>P(S(m)) &#x3D; S(m)^e \ mod \ n &#x3D; (m^d \ mod \ n)^e \ mod \ n &#x3D; m<br>$$<br>利用这种的公匙算法和私匙算法就可以完成非对称密匙密码体制加密的任务。</p>
<p>RSA 的安全性依赖于<strong>目前没有一个已知的算法可以快速对一个大数进行因数分解。</strong>如果相对RSA有更深的了解可以翻到文末看看对 RSA 算法的证明，不过不清楚也没事，那毕竟是数学上的事。</p>
<p>RSA的缺陷是，当 e 和 d 较大时，<strong>指数运算与取模运算都是比较慢的操作，并不适合用来频繁通信</strong>，因此在未来的很长一段时间内对称密匙与非对称密匙共存都是共同的主角，在 HTTPS 中我们将看到 SSL 利用非对称密匙体制来协商一系列密匙，而在协商完毕后使用对称密匙进行通信。</p>
<h3 id="不可信的公匙"><a href="#不可信的公匙" class="headerlink" title="不可信的公匙"></a>不可信的公匙</h3><img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221192055583.png" alt="image-20211221192055583" style="zoom:33%;" />

<p>Alice 要如何知道自己所知道的公匙真的是 Bob 的呢？攻击者完全宣称自己的公匙和私匙是 B 的！使用数字签名？不好意思，数字签名本身也是依赖公匙私匙体制来实现的。</p>
<p>我们需要一个可以信得过的机构告诉我们公匙是否合法，这种机构就是 CA（认证中心)，机构会为每个注册的实体签发一份数字证书，这个数字证书包括注册人的公匙和他的标识信息，CA 会用自己的私匙加密整数以防止服务商伪造整数(数字签名)。</p>
<p>在 Bob 发送公匙给 Alice 的时候会顺便发送 CA 签发的证书，Alice 比对证书来验证 Bob 的合法性。现在攻击者无法冒充 Bob 了，因为攻击者没有证书，即使攻击者也有证书，证书上也会有他的名字，Alice 可以很快知道这个 Bob 是冒充的。</p>
<p><img src="https://img-blog.csdnimg.cn/20200712113025182.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlb2xpYXM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="报文完整性"><a href="#报文完整性" class="headerlink" title="报文完整性"></a>报文完整性</h2><p>为维护报文完整性，我们需要对报文进行<strong>多对一映射</strong>(散列)，例如将 1000 比特的报文映射为 128 比特的<strong>摘要(也称报文鉴别码，MAC)<strong>，该摘要的每一个比特都与源报文相关，因此发送报文时将</strong>摘要</strong>一起发送，而接受报文时，根据报文重新计算一遍摘要，比对原先的摘要，如果不同则说明报文可能被篡改。</p>
<blockquote>
<p>摘要长度须是固定的，这样接收方才能正确的取出摘要。</p>
</blockquote>
<p>攻击者仅篡改报文或者仅篡改摘要都是不可行的，但如果攻击者知晓了散列函数，<strong>更改报文并同时替换摘要</strong>，此时接收方收到报文并计算摘要，并不会发现有任何问题，然而报文已经被篡改了！</p>
<p>所以，为维护报文完整性，我们仍然需要一个密匙，发送方在计算散列时<strong>将密匙(字符串)附加在报文上计算摘要</strong>(发送的时候不会发送密匙)，而在接收方同时也附加密匙计算摘要，这样便解决了上述问题，因为攻击者无法不知道通信的密匙！</p>
<p><strong>注意，整个报文和摘要也需要保证报文机密性。现在需要对整个报文+摘要进行加密。</strong></p>
<img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221174855736.png" alt="image-20211221174855736" style="zoom: 50%;" />

<h3 id="常用的密码散列函数-MD5-和-SHA-1、SHA-2、SHA-3"><a href="#常用的密码散列函数-MD5-和-SHA-1、SHA-2、SHA-3" class="headerlink" title="常用的密码散列函数 MD5 和 SHA-1、SHA-2、SHA-3"></a>常用的密码散列函数 MD5 和 SHA-1、SHA-2、SHA-3</h3><p>散列函数必须要足够安全，至少要保证<strong>理论上</strong>不可能有多个不同的报文可以映射到相同的摘要，MD5声称它可以做到这一点，不过随着密码学的发展，在 2004 年后 MD5 变得不安全了，取而代之的是 SHA-1，SHA-1是 MD5 的加强版，思想上与 MD5 类似。不幸的是，2012年后，SHA-1也被指责说是不安全的，在 2015 年，破解 SHA-1甚至只需要不到一个小时，现在 SHA-1 已经被 SHA-2、SHA-3 所取代。</p>
<p>不过 MD5 的思想依赖未改变，后续的算法都是基于 MD5 算法思想加强的，MD5 的算法能够将任意长的报文映射为 128 bit 的摘要，过程如下：</p>
<ol>
<li>将任意长的报文采用<strong>二进制模运算</strong>模 2<sup>64</sup> 计算其余数(64位)，追加报文尾部。</li>
<li>在报文与余数之间填充 1~512 bit，使得填充后总长度是 512 的整数倍。填充的首位是1，后面都是0。</li>
<li>把追加后的报文分成一个个 512bit 数据块，每个 512 字节分为 4 个 128bit数据块，与 4 个 32bit 幻数分别进入主循环，每个幻数与每个 128bit 数据块进行交互运算，最终输出 4 个幻数，这四个幻数与这 512 字节存在某种联系，然后继续与下一个 512bit 进行循环，最终 4个幻数组合起来为 128bit 鉴别码。</li>
</ol>
<p>更多细节可自行了解。</p>
<h2 id="端点鉴别"><a href="#端点鉴别" class="headerlink" title="端点鉴别"></a>端点鉴别</h2><h3 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h3><p>接收方 B 如何知道报文是否是 A 发送的呢？有了非对称密码加密，这点很容易做到。</p>
<p>A 可以用自己的私匙对 m 再次进行加密得到 C<sub>1</sub>，而 B 收到报文C<sub>1</sub> 后，B 尝试用 A 的公匙进行解密，如果得到的报文是 m，则可以确认 A 的身份，因为只有用 A 的密匙加密才能用 A 的公匙解密，所以可以确定对方持有 A 的密匙。</p>
<p>至于这个报文 m 到底该是什么，取决于具体的实现。它可以是确定好的一段数据，也可以是通信时的普通报文，不过大多数情况下，通常会对报文摘要(鉴别码)进行签名，因为对普通报文签名开销太大了，报文可能非常长！</p>
<p>如果对摘要签名，接收方用发送方的公匙解密即可得到摘要，它可以根据报文重新计算摘要以比对正确性，如果比对不成功，可能会有两种可能，要么是签名错误、要么是报文完整性丢失，无论哪种情况 B 肯定都不会信任该报文了。</p>
<h2 id="常见的攻击"><a href="#常见的攻击" class="headerlink" title="常见的攻击"></a>常见的攻击</h2><p>攻击在大类上分为主动攻击和被动攻击，主动攻击即主动发起攻击，可能涉及到报文篡改等；被动攻击则是指只是秘密的窃听你的报文，不会更改你的报文。被动攻击通常难以防范，只能采取更复杂的加密算法进行抑制，我们今天谈的主要是主动攻击。</p>
<p>在讨论攻击前，我们先假设我们上述讨论的所有措施全部使用，在此基础上看看还能有什么些攻击。</p>
<p><img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221194833395.png" alt="image-20211221194833395"></p>
<h3 id="协议有关的攻击"><a href="#协议有关的攻击" class="headerlink" title="协议有关的攻击"></a>协议有关的攻击</h3><h4 id="SYN泛洪攻击"><a href="#SYN泛洪攻击" class="headerlink" title="SYN泛洪攻击"></a>SYN泛洪攻击</h4><p>SYN 泛洪我在 TCP 总结中已经讲过了，具体就不在说了，可参考我的博客：<a href="./TCP%E8%AF%A6%E8%A7%A3.md">万字长文总结TCP</a></p>
<h4 id="重排序攻击"><a href="#重排序攻击" class="headerlink" title="重排序攻击"></a>重排序攻击</h4><p>这仍是针对 TCP 协议的攻击，即使 TCP 数据报已经被加密，但 TCP 首部仍然是明文的，攻击者可以劫持 TCP 报文，<strong>重排序(乱排序) TCP 首部中的序号字段</strong>，使得接收方接收到的字节流是乱序的，且接收方<strong>无法判断出异常</strong>，信以为真。</p>
<p>针对这种攻击的防御就是在 TCP 加密的数据报中继续定义序号，接收方验证加密的数据报中序号以判断顺序。</p>
<h4 id="ARP欺骗"><a href="#ARP欺骗" class="headerlink" title="ARP欺骗"></a>ARP欺骗</h4><p>ARP 协议是解析 MAC 地址的一种协议，当本地网关在自己的缓存表中没有找到 IP 对应的 MAC 地址，就会在局域网中广播消息，寻找对应 IP 的主机，而所有主机会监听 MAC 报文，如果是在寻找自己则即使回答自己的 MAC 地址。</p>
<p>在 <strong>Linux 上可利用 <code>arpspoof</code>命令来进行 ARP 地址欺骗</strong>(快去试试吧，我成功的攻击了我的好兄弟)，从而达到让局域网内用户断网的攻击，有兴趣的朋友门可以自己去试一试，篇幅有限就不在这里说了。</p>
<blockquote>
<p><strong>ARP欺骗</strong>（英语：<strong>ARP spoofing</strong>），又称<strong>ARP毒化</strong>（<strong>ARP poisoning</strong>，网络上多译为<strong>ARP病毒</strong>）或<strong>ARP攻击</strong>，是针对<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BB%A5%E5%A4%AA%E7%BD%91">以太网</a><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE">地址解析协议</a>（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ARP">ARP</a>）的一种攻击技术，通过欺骗局域网内访问者PC的网关MAC地址，使访问者PC错以为攻击者更改后的MAC地址是网关的MAC，导致网络不通。此种攻击可让攻击者获取<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91">局域网</a>上的<strong>数据包甚至可篡改数据包</strong>，且可让网络上特定计算机或所有计算机无法正常连线。最早探讨ARP欺骗的文章是由Yuri Volobuev所写的《ARP与ICMP转向游戏》（<em>ARP and ICMP redirection games</em>）。</p>
</blockquote>
<h5 id="冒充网关"><a href="#冒充网关" class="headerlink" title="冒充网关"></a>冒充网关</h5><img src="https://www.sundray.com.cn/ueditor/net/upload/image/20170930/6364236228867675789375080.png" alt="图片 2.png" style="zoom: 67%;" />

<p>如果存在不法分子冒充网关(局域网内的，局域网外的无法通过网关)发送 ARP Request 报文，则局域网上的主机可能会错把黑客当作自己的网关，这些主机可能会更新自己的 MAC 缓存表，将黑客认为是自己的网关，则之后所有的信息都发给自己的网关。</p>
<p>事实上，如果我们的数据都进行了<strong>加密和报文完整性鉴别</strong>的话，那么黑客即使充当了网关也只能干巴巴的看着我们的加密数据，篡改也没有用，但是，黑客却可以让局域网内所有主机都无法访问外网，造成断网现象(或者是故意让网络变慢)，而且，黑客可以进行重放攻击。</p>
<p>不过，不是什么数据都会进行加密的，一旦你露出马脚，黑客就会立马攻击你，例如我们很快就会说到的 DNS 欺骗</p>
<h5 id="充当中间人-——-双重欺骗"><a href="#充当中间人-——-双重欺骗" class="headerlink" title="充当中间人 —— 双重欺骗"></a>充当中间人 —— 双重欺骗</h5><p>黑客充当中间人窃听主机与网关的通信，例如下图：</p>
<p><img src="https://img-blog.csdnimg.cn/20181126012733369.jpeg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ZhZWxvdmVyZm9yZXZlcg==,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>此时主机 PC1 以为 PC2 是网关，而网关以为 PC2 是 PC1，于是接下来所有的信息都将会发送给 PC2，这种欺骗方式是冒充网关的加强版，黑客现在不仅冒充网关，还冒充主机。</p>
<h5 id="防范方法"><a href="#防范方法" class="headerlink" title="防范方法"></a>防范方法</h5><ul>
<li>配置 MAC 地址为静态地址，不允许改变。这种方法对网关通常不太可取，不过主机可以将他知道的网关地址配置成静态的。</li>
<li>网上设备可借由<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/DHCP">DHCP</a>保留网络上各计算机的MAC地址，在伪造的ARP数据包发出时即可侦测到。通俗点说，主机在注册IP时同时注册了自己的MAC地址，使得路由完全掌握所有 IP 对应的 MAC地址，因此能够检测假冒ARP包。此方式已在一些厂牌的网上设备产品所支持。</li>
<li>网关更新速度更加频繁些，避免“一次跌倒，则放弃挣扎”。</li>
<li>嗅探网络 ARP 包，如果有不正当(对网关而言，除自己发的Request之外不应该有其他人发送 Request)或ARP包过多时，则及时告知网络管理员。</li>
</ul>
<blockquote>
<p>ARP欺骗亦有正当用途。其一是在一个需要登录的网上中，让未登录的计算机将其浏览网页强制转向到登录页面，以便登录后才可使用网上。另外有些设有备援机制的网上设备或<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8">服务器</a>，亦需要利用ARP欺骗以在设备出现故障时将讯务导到备用的设备上。 [1] </p>
</blockquote>
<h4 id="DNS欺骗"><a href="#DNS欺骗" class="headerlink" title="DNS欺骗"></a>DNS欺骗</h4><p>DNS 欺骗就是攻击者冒充域名服务器的一种欺骗行为。 原理：如果可以<strong>冒充域名服务器</strong>，然后把查询的 IP 地址设为攻击者的 IP 地址，这样的话，用户上网就只能看到攻击者的主页，而不是用户想要取得的网站的主页了，这就是 DNS 欺骗的基本原理。DNS 欺骗其实并不是真的 “黑掉” 了对方的网站，而是冒名顶替、招摇撞骗罢了。</p>
<p>例如你正在请求某个银行的网址，你的 DNS 请求被黑客劫持了，黑客将返回了个假冒的 IP 给你，而这个假冒 IP 返回的页面和真实的一模一样，你信以为真，于是你的所有信息都暴露了。</p>
<p>黑客要如何劫持你的 dns 请求呢？通常有两种思路，一种是直接黑进你的 DNS Server，冒充DNS服务器，不过这点难度比较大；第二种就是常见的中间人劫持了，例如 ARP 欺骗。</p>
<p>此外，某些病毒可能会修改你的 host 文件(DNS 缓存文件)。</p>
<p><strong>防范：</strong></p>
<ul>
<li>直接使用 ip 而不使用域名。</li>
<li>定期检查 host 文件。</li>
<li>防范 ARP 欺骗。</li>
<li>要求DNS服务器使用数字签名。</li>
<li>检测 DNS 应答，通常假冒的应答要比真实的应答简单的多。</li>
<li>采用 HTTPS 而不是 HTTP，碰到不合法证书提示立马警觉。</li>
</ul>
<h3 id="协议无关的攻击"><a href="#协议无关的攻击" class="headerlink" title="协议无关的攻击"></a>协议无关的攻击</h3><h4 id="重放攻击"><a href="#重放攻击" class="headerlink" title="重放攻击"></a>重放攻击</h4><p>重放攻击的基本原理就是<strong>把以前窃听到的数据原封不动地重新发送给接收方</strong>。很多时候，网络上传输的数据是加密过的，此时窃听者无法得到数据的准确意义。但如果他知道这些数据的作用，就可以在不知道数据内容的情况下通过再次发送这些数据达到愚弄接收端的目的。例如，有的系统会将鉴别信息进行简单加密后进行传输，这时攻击者虽然无法窃听密码，但他们却可以首先截取加密后的口令然后将其重放，从而利用这种方式进行有效的攻击。</p>
<p>例如下图：</p>
<img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221204451453.png" alt="image-20211221204451453" style="zoom: 67%;" />

<p>你可能觉得重放攻击有什么大不了的，黑客又不知道具体的内容，如果这样想你就错了，假如你正给银行发送请求转账给别人，但此时你的所有请求都被黑客嗅探并且保存了下来，在某一时刻，黑客重放这些请求，于是你就发现你的钱全没了。</p>
<p><strong>防范方法：</strong></p>
<ul>
<li><p><strong>加随机数</strong>。该方法优点是认证双方不需要时间同步，双方记住使用过的随机数，如发现报文中有以前使用过的随机数，就认为是重放攻击。缺点是需要额外保存使用过的随机数，若记录的时间段较长，则保存和查询的开销较大。 </p>
</li>
<li><p><strong>加时间戳</strong>。该方法优点是不用额外保存其他信息。缺点是认证双方需要准确的时间同步，同步越好，受攻击的可能性就越小。但当系统很庞大，跨越的区域较广时，要做到精确的时间同步并不是很容易。</p>
</li>
<li><p>**加版本号(或序号、流水号)**。就是双方在报文中添加一个逐步递增的整数(例如 TCP)，只要接收到一个不连续的流水号报文(太大或太小)，就认定有重放威胁。该方法优点是不需要时间同步，保存的信息量比随机数方式小。缺点是一旦攻击者对报文解密成功，就可以获得流水号，从而每次将流水号递增欺骗认证端。</p>
</li>
<li><p><strong>一次性口令</strong>。例如，和 cookie、token 机制有点像，但又不完全一样，该口令只在一次服务内有效，当服务完成后口令即为过期失效。</p>
</li>
</ul>
<h4 id="中间人攻击"><a href="#中间人攻击" class="headerlink" title="中间人攻击"></a>中间人攻击</h4><img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211221210452652.png" alt="image-20211221210452652" style="zoom: 80%;" />

<p>如上图所示，这里我们假设 A-B 双方没有采用某种方式验证私匙和公匙的合法性，那么此时问题就大了，服务器错把C的公匙当作A的公匙，从而服务器发给 A 的数据完全暴露在 C 的眼皮底下。</p>
<p>这个例子再次告诉我们验证公匙的必要性，同时 CA 的可信程度也显得极为重要。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><img src="https://happysnaker-1306579962.cos.ap-nanjing.myqcloud.com/img/typora/image-20211223212649249.png" alt="image-20211223212649249" style="zoom:50%;" />

<h2 id="附-RSA-算法证明"><a href="#附-RSA-算法证明" class="headerlink" title="附 RSA 算法证明"></a>附 RSA 算法证明</h2><p>我们的算法结论是：<br>$$<br>(m^e \ mod \ n)^d \ mod \ n &#x3D; (m^d \ mod \ n)^e \ mod \ n &#x3D; m \tag {A}<br>$$<br>现在我们来指出如何选出 e、d，首先我们选择<strong>两个大素数 p、q</strong>，则取 n、z 满足：<br>$$<br>\ n &#x3D; p \times q，z &#x3D; (p - 1)(q - 1)，n &gt; m \tag1<br>$$<br>现在我们选择一个数 <strong>e</strong>，满足：<br>$$<br>e &lt; n \ &amp;&amp; \ e 与 n互质<br>$$<br>给定 e，我们可以选择 d，使得：<br>$$<br>(e \times d) \ mod \ z &#x3D; 1 \tag2<br>$$<br>这样我们就选出了 e、d 的值，欲证明结果，需要引入数论里的一个结论，即当 n、z 满足我们上面 (1) 式，有：<br>$$<br>x^y \ mod \ n &#x3D; x^{(y \ mod \ z)} \ mod \ n \tag3<br>$$</p>
<blockquote>
<p>该结论由 Kaufman 提出</p>
</blockquote>
<p>现在，令 x &#x3D; m，y &#x3D; ed，带入 (3) 式有：<br>$$<br>m^{ed} \ mod \ n &#x3D; m^{(ed \ mod \ z)} \ mod \ n \tag4<br>$$<br>结合 (2)、(4) 可知：<br>$$<br>m^{ed} \ mod \ n &#x3D; m \ mod \ n  &#x3D; m\tag5<br>$$<br>我们都知道简单数学中有一条取模运算的分配律：<br>$$<br>(a \times b) \ mod \ n &#x3D; [(a \ mod \ n) \times (b \ mod \ n)] \ mod \ n \tag6<br>$$<br>根据 (6) 式可推：<br>$$<br>(a^d) \ mod \ n &#x3D;  (a \ mod \ n)^d \ mod \ n \tag7<br>$$<br>结合 (5) (7) 而式有：<br>$$<br>m^{ed} \ mod \ n &#x3D; (m^e)^d \ mod \ n &#x3D; (m^e \ mod \ n)^d \ mod \ n &#x3D; m \<br>m^{ed} \ mod \ n &#x3D; (m^d)^e \ mod \ n &#x3D; (m^d \ mod \ n)^e \ mod \ n &#x3D; m<br>$$<br>从而 (A) 式得证。</p>
<blockquote>
<p>勘误，RSA 的算法应该并不是 1 式，1 式是数论中的一个结论，RSA 算法的核心应该是 e、d 的生成。<br>$$<br>(m^e \ mod \ n)^d \ mod \ n &#x3D; m^{ed} \  mod \ n&#x3D; (m^d \ mod \ n)^e \ mod \ n &#x3D; m<br>$$<br>这是恒成立的。</p>
</blockquote>

        </div>



        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent">
        </div>
        <!-- 评分 -->
        <div class="single-reward">
          
          <!-- 五星评分 -->
<div id="wpac-rating"></div>
<script type="text/javascript">
wpac_init = window.wpac_init || [];
wpac_init.push({widget: 'Rating', id: 23889});
(function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = 'https://embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
})();
</script>
<!-- <a target="_blank" rel="noopener" href="https://widgetpack.com" class="wpac-cr">Star Rating WIDGET PACK</a> -->
          
        </div>
        <!-- 自定义署名方式 -->
        <footer class="post-footer">
          <div class="post-lincenses" style="color: #ff9966;">
            欢迎转载，转载时请注明来源哦！
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" style="color: #ff9966;" target="_blank"
              rel="nofollow">
              <i class="fa fa-creative-commons" aria-hidden="true"></i>ncsa4.0</a>
          </div>
          
          <div class="post-tags" style="color: #a39391">
            <span><i class="fa fa-tags"></i>
              
              <a href="/blog/tags/%E6%9A%82%E6%97%A0%E6%A0%87%E7%AD%BE/" style="color: #716e77;">暂无标签<em>·</em></a>
              
            </span>
            <span>
              <i class="iconfont icon-file"></i>
              
              <a href="/blog/categories/%E6%9A%82%E6%97%A0%E5%88%86%E7%B1%BB/" style="color: #716e77;">暂无分类</a>
              
            </span>
          </div>
          
          <div class="post-share" >
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
        <!-- <div class="tag-cloud">
          <div class="tag-cloud-title">
          </div>
          <div class="tag-cloud-tags">
            <a href="/blog/tags/%E6%9A%82%E6%97%A0%E6%A0%87%E7%AD%BE/" style="font-size: 10px; color: #f06966">暂无标签</a>
          </div>
        </div> -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
        
        <div class="post-nepre half previous">
          
            <a href="/blog/post/b310.html" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src=""
                  style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)"
                  src="">
              </div>
              <span class="label">Previous Post</span>
              <div class="info">
                <h3>线程间同步方式</h3>
                <hr>
              </div>
            </a>
          </div>
          
          
          
          <div class="post-nepre half next">
            
              <a href="/blog/post/ea8d.html" rel="next">
                <div class="background">
                  <img class="lazyload" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/loader/orange.progress-bar-stripe-loader.svg" data-src=""
                    style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;"
                    onerror="imgError(this,3)" src="">
                </div>
                <span class="label">Next Post</span>
                <div class="info">
                  <h3>设计模式之代理模式(Proxy)</h3>
                  <hr>
                </div>
              </a>
            </div>
            
      </section>
      <!-- 加密文章隐藏评论 -->
      <section class="comment" >
        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<div id="gitalk-container" class="comment"></div> 
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="/js/md5.min.js"></script>
<script type="text/javascript">
	var gitalk = new Gitalk({
  	clientID: '',
  	clientSecret: '',
  	repo: 'cungudafa.github.io',
  	owner: 'cungudafa',
	admin: ['cungudafa'],
	distractionFreeMode: 'true',
    id: md5(location.pathname)
})
gitalk.render('gitalk-container') 
</script>

      </section>
      <!-- 加密文章隐藏作者信息 -->
      
    </main><!-- #main -->
  </div><!-- #primary -->
</div>


<!--评论配置-->



      <!-- body.end -->
    </div>
    <!-- search -->    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            // PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
        },
        ROOT_URL: '/blog/',
        CONTENT_URL: '/blog/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- footer-->    
    
    <footer id="colophon" class="site-footer" role="contentinfo">
    <div class="site-info">
        <div class="footertext">
          <div class="img-preload">
              <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
              <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
          </div>
        </div>
        <!-- 网站数据统计 -->
        <div class="footer-device">
          <p style="font-family: 'Ubuntu', sans-serif;">
            <span style="color: #ff9999;padding-left: 20px;">
                <!-- 网站运行时间统计 -->
                <i class="fa fa-clock-o" aria-hidden="true"></i>
                <span id="time" align="center">载入时间中...</span>
                <script>
                var now = new Date(); 
                function createtime() { 
                      var grt= new Date("Wed Feb 12 2020 01:20:00 GMT+0800 (中国标准时间)");//在此处修改你的建站时间
                      now.setTime(now.getTime()+250); 
                      days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                      if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                      mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                      snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                      document.getElementById("time").innerHTML = "小破站在各种灾难中苟活了 "+ dnum +" 天 "+hnum + " 小时 " + mnum + " 分 " + snum + " 秒";      
                  } 
                  setInterval("createtime()",250);
                </script>
            </span> 
          </p>
        </div>
        <div class="footer-device">
          <p style="font-family: 'Ubuntu', sans-serif;">
            <span style="color: #b9b9b9;padding-left: 20px;">
              <!-- 全网站字数统计wordcount -->
              
              <!-- 不蒜子网页计数器 -->
              
              <span style="padding-left: 20px;"><i class="fa fa-fire" aria-hidden="true" style="color: #ff9999;display:inline-block"></i><span id="busuanzi_container_site_pv">总访问量： <span id="busuanzi_value_site_pv" style="color:#ff9999;"></span>次</span>
              </span>
              
              
              <span style="padding-left: 20px;"><i class="fa fa-user" aria-hidden="true" style="color: #ff9999;display:inline-block"></i><span id="busuanzi_container_site_uv">总访问人数： <span id="busuanzi_value_site_uv" style="color:#ff9999;"></span>人</span>
              </span>
              
            </span>
          </p>
        </div>
        <!-- 作者注明 -->
        <div class="footer-device">
          <p style="font-family: 'Ubuntu', sans-serif;">
              <span style="color: #b9b9b9;">
                Copyright &copy; 2023
                &nbsp;<a style="color: #ff9999;display:inline-block"> Happysnaker </a>
                &nbsp;<i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> 
                &nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank" style="color: #ff9999;display:inline-block">Hexo</a>
                |&nbsp;Theme&nbsp;<a href="https://gitee.com/cungudafa/hexo-theme-sakuraplus" target="_blank" style="color: #ff9999;display:inline-block">SakuraPlus</a>
              </span>
          </p>
        </div>
         <!-- 网站作者版权注明 -->
         
          <div id="footer-info" class="inner">
            <p style="font-family: 'Ubuntu', sans-serif;">
              <span style="color: #ff9999;">
                
              </span>
            </p>
          </div>
        
    </div><!-- .site-info -->
</footer>


<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/InsightSearch.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/sakura-app.js"></script>


<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!-- fancybox大图查看 需jq -->

  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/js/jquery.fancybox.min.js"></script>
  <script>
    $('[data-fancybox="images"]').fancybox({
      thumbs : {
        autoStart : true //缩略图
      }
    });
    $('[data-fancybox]').fancybox({
      protect: true,//图片右键不能下载
      youtube : {
          controls : 0,
          showinfo : 0
      },
      vimeo : {
          color : 'f00'
      }
    });
  </script>


<!-- 自适应浏览器 -->
<script type="text/javascript">
  /* <![CDATA[ */
  if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
    var Poi = {"pjax":"0","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
  } else {
    var Poi = {"pjax":"0","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
  }
  /* ]]> */
  
  </script>
  <script>
  $(document).ready(function() {
    if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
      if ($(".pattern-center").length > 0) { //有图的情况
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '.toc', // 放置目录的容器
            // Where to grab the headings to build the table of contents.
            contentSelector: '.entry-content', // 正文内容所在
            // Which headings to grab inside of the contentSelector element.
            scrollSmooth: true,
            headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
            headingsOffset: -400,
            scrollSmoothOffset: -85
        });
      } else {
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '.toc', // 放置目录的容器
            // Where to grab the headings to build the table of contents.
            contentSelector: '.entry-content', // 正文内容所在
            // Which headings to grab inside of the contentSelector element.
            scrollSmooth: true,
            headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
            headingsOffset: -85,
            scrollSmoothOffset: -85
        });
      }
      var offsetTop = $('.toc').offset().top - 95;
      window.onscroll = function() {
        var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
        if (scrollTop >= offsetTop) {
          $('.toc').addClass('toc-fixed');
        } else {
          $('.toc').removeClass('toc-fixed');
        }
      }
    }
  });
  </script>
    <!-- Side menu -->
    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <!-- Floating window -->
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/cungudafa/cdn/img/custom/cungudafa.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">happysnaker开心</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/happysnaker" class="fa " target="_blank" style="color: #; margin-left: 20px"></a>
      
        <a href="https://www.zhihu.com/people/tian-xia-you-dao-81" class="fa " target="_blank" style="color: #; margin-left: 20px"></a>
      
        <a href="http://gitee.com/happysnaker" class="fa " target="_blank" style="color: #; margin-left: 20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/blog/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/blog/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/blog/archives/">
                  <i class="fa fa-line-chart" aria-hidden="true"></i>
                  统计
                </a>
              </li>
            
              <li>
                <a href="/blog/tags">
                  <i class="fa fa-tags" aria-hidden="true"></i>
                  标签
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/blog/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/blog/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
          </ul>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2020 hexo-sakuraplus</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  
   <!-- pages壁纸切换 -->
 
    <div class="skin-menu no-select" id="mainskin"  style="position: fixed">
        <div class="theme-controls row-container">
            <ul class="menu-list">
                <li id="white-bg"> <i class="fa fa-television" aria-hidden="true"></i></li>
                <li id="sakura-bg"> <i class="iconfont icon-sakura"></i></li>
                <li id="gribs-bg"> <i class="fa fa-slack" aria-hidden="true"></i></li>
                <li id="KAdots-bg"> <i class="iconfont icon-dots"></i></li>
                <li id="totem-bg"> <i class="fa fa-optin-monster" aria-hidden="true"></i></li>
                <li id="pixiv-bg"> <i class="iconfont icon-pixiv"></i></li>
                <li id="bing-bg"> <i class="iconfont icon-bing"></i></li>
                <li id="dark-bg"> <i class="fa fa-moon-o" aria-hidden="true"></i></li>
            </ul>
        </div>
        <div class="font-family-controls row-container">
            <button type="button" class="control-btn-serif selected" data-mode="serif" onclick="mashiro_global.font_control.change_font()">Serif</button>
            <button type="button" class="control-btn-sans-serif" data-mode="sans-serif" onclick="mashiro_global.font_control.change_font()">Sans Serif</button>
        </div>
    </div>   
    <canvas id="night-mode-cover"></canvas> 
        <div class="changeSkin-gear no-select">
        <div class="keys" id="setbtn"> <span id="open-skinMenu"> 切换壁纸 | SCHEME TOOL 
            &nbsp;<i class="iconfont icon-gear inline-block rotating"></i> </span></div>
    </div><!-- skin.end -->

  <!-- left side bar -->

 </body>
</html>